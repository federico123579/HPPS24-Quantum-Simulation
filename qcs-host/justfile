alias bd := build-debug
alias br := build-release
alias d := doc
alias t := test
alias e := export

_default:
    just --choose

run-expansion: build-release
    ./target/release/expansion
    mv golden-vectors.dat ../../hls/src/tests/tensor-expansion/golden-vectors.dat

run-matmul: build-release
    ./target/release/matmul
    mv golden-vectors.dat ../../hls/src/tests/matrix-multiplication/golden-vectors.dat

run-combined: build-release
    ./target/release/combined
    mv golden-vectors.dat ../../hls/src/tests/combined/golden-vectors.dat

build-debug:
    cargo build --bins
    mv target/debug/export qcs-export
    mv target/debug/compute qcs-compute

build-release: clean
    cargo build --release --bins
    mv target/release/export qcs-export
    mv target/release/compute qcs-compute
    mv target/release/compile qcs-compile

clean:
    rm -f ./qcs-export ./qcs-compute

doc:
    cargo doc

test:
    cargo nextest run && cargo test --doc

export: clean build-release
    RUST_LOG=debug ./qcs-export ./circuits/*.qasm ../analysis/qiskit-jn/q07-05.qasm ../analysis/qiskit-jn/q09-05.qasm ../analysis/qiskit-jn/q10-05.qasm ../analysis/qiskit-jn/q10-10.qasm
